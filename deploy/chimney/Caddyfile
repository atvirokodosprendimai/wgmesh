# Caddyfile for chimney edge servers
# Caddy handles TLS automatically via Let's Encrypt / ZeroSSL
#
# Architecture:
#   Client → chimney.beerpub.dev → Caddy (TLS termination) → chimney origin (:8080)
#
# Caching is handled by the chimney origin server (in-memory with tiered TTLs),
# not at the Caddy layer. Caddy acts purely as a TLS-terminating reverse proxy.

chimney.beerpub.dev {
	# Reverse proxy to chimney origin server
	reverse_proxy localhost:8080 {
		# Health check
		health_uri /healthz
		health_interval 10s
		health_timeout 3s
	}

	# Response headers
	header {
		X-Served-By {system.hostname}
		-Server
	}

	# Logging to stdout (captured by systemd journald)
	log {
		output stdout
	}
}
